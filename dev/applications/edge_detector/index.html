<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Edge detection · FuzzyLogic.jl</title><meta name="title" content="Edge detection · FuzzyLogic.jl"/><meta property="og:title" content="Edge detection · FuzzyLogic.jl"/><meta property="twitter:title" content="Edge detection · FuzzyLogic.jl"/><meta name="description" content="Documentation for FuzzyLogic.jl."/><meta property="og:description" content="Documentation for FuzzyLogic.jl."/><meta property="twitter:description" content="Documentation for FuzzyLogic.jl."/><meta property="og:url" content="https://lucaferranti.github.io/FuzzyLogic.jl/applications/edge_detector/"/><meta property="twitter:url" content="https://lucaferranti.github.io/FuzzyLogic.jl/applications/edge_detector/"/><link rel="canonical" href="https://lucaferranti.github.io/FuzzyLogic.jl/applications/edge_detector/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="FuzzyLogic.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FuzzyLogic.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/mamdani/">Build a Mamdani inference system</a></li><li><a class="tocitem" href="../../tutorials/sugeno/">Build a Sugeno inference system</a></li><li><a class="tocitem" href="../../tutorials/type2/">Build a type-2 inference system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Applications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Edge detection</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Fuzzy-system-design"><span>Fuzzy system design</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Inference system API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/fis/">Types</a></li><li><a class="tocitem" href="../../api/logical/">Logical connectives</a></li><li><a class="tocitem" href="../../api/aggregation/">Aggregation methods</a></li><li><a class="tocitem" href="../../api/defuzzification/">Defuzzification methods</a></li></ul></li><li><a class="tocitem" href="../../api/memberships/">Membership functions</a></li><li><a class="tocitem" href="../../api/readwrite/">Reading/Writing</a></li><li><a class="tocitem" href="../../api/genfis/">Learning fuzzy models</a></li><li><a class="tocitem" href="../../api/plotting/">Plotting</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s Guide</a></li><li><a class="tocitem" href="../../changelog/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Applications</a></li><li class="is-active"><a href>Edge detection</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Edge detection</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lucaferranti/FuzzyLogic.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lucaferranti/FuzzyLogic.jl/blob/main/docs/src/literate/applications/edge_detector.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fuzzy-edge-detector"><a class="docs-heading-anchor" href="#Fuzzy-edge-detector">Fuzzy edge detector</a><a id="Fuzzy-edge-detector-1"></a><a class="docs-heading-anchor-permalink" href="#Fuzzy-edge-detector" title="Permalink"></a></h1><p>This tutorial shows how fuzzy logic can be applied to image processing. It showcases how <code>FuzzyLogic.jl</code> seamlessly composes with common Julia image processing libraries and works out-of-the box.</p><p>This tutorial builds a fuzzy edge detector and it is inspired from the matlab tutorial available <a href="https://www.mathworks.com/help/fuzzy/fuzzy-logic-image-processing.html">here</a>.</p><div class="admonition is-success"><header class="admonition-header">Try it yourself!</header><div class="admonition-body"><p>Read this as Jupyter notebook <a href="https://nbviewer.jupyter.org/github/lucaferranti/FuzzyLogic.jl/blob/gh-pages/dev/notebooks/edge_detector.ipynb">here</a></p></div></div><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>We want to design an edge detector. That is, a function that takes an image as input and finds the edges in the image. Our function should produce a new image, with edges highlighted in black and flat areas in white.</p><p>First, let&#39;s load the image processing tools we need in this tutorial.</p><pre><code class="language-julia hljs">using TestImages, ImageFiltering, ImageShow, ImageCore

img = Gray.(testimage(&quot;house&quot;))</code></pre><img src="9197f7c2.png" alt="Example block output"/><p>Next, we need to model our problem. When we cross an edge, we have a transition from a clearly delimited area to another. Hence, a pixel is on an edge if moving in its neighborhood we see some change in intensity. If, on the other hand, in the pixel neighborhood there is no change, then it belongs to a flat area.</p><p>Hence, to detect edges we need to compute the gradient of the image at each pixel. This can be done using <code>imgradients</code> from <a href="https://github.com/JuliaImages/ImageFiltering.jl">ImageFiltering</a>. This function will return two images, one containg the gradient x-component at each pixel, and one containing the y-component at each pixel. For better visualization, these gradient images are renormalized so that their maximum in absolute value is <span>$1$</span>.</p><pre><code class="language-julia hljs">img_y, img_x = imgradients(img, KernelFactors.sobel)

img_y /= Float64(maximum(abs.(img_y)))
img_x /= Float64(maximum(abs.(img_x)))

img_y</code></pre><img src="04a5a26a.png" alt="Example block output"/><pre><code class="language-julia hljs">img_x</code></pre><img src="f9bd6ac9.png" alt="Example block output"/><h2 id="Fuzzy-system-design"><a class="docs-heading-anchor" href="#Fuzzy-system-design">Fuzzy system design</a><a id="Fuzzy-system-design-1"></a><a class="docs-heading-anchor-permalink" href="#Fuzzy-system-design" title="Permalink"></a></h2><p>Now we want to design a fuzzy system that takes as input the gradient x- and y- components and produces as output the intensity of the new image. Particularly, in the output image we want to plot flat areas in white (intensity close to <span>$1$</span>) and edges in black (intensity close to <span>$0$</span>).</p><p>Based on our previous discussion, a pixel belongs to a flat area if it has zero gradient (i.e. both x- and y-components are zero). If the gradient is non-zero (either x- or y-component is non-zero) then it belongs to an edge. Hence for our fuzzy edge detector we can use the following rules</p><ul><li>If the gradient x-component is zero and the gradient y-component is zero, then the output intensity is white.</li><li>If the gradient x-component is nonzero or the gradient y-compnent is non-zero, then the output intensity is black.</li></ul><p>Hence, for the input, we will use a single membership function <code>zero</code>, which is a sharp Gaussian centered at zero. For the outupt, we have two membership functions, <code>black</code> and <code>white</code>. Recalling that a black pixel means intensity zero and a white pixel intensity one, we will use for <code>black</code> a linear membership function, that decreases from <span>$1$</span> to <span>$0$</span> as the intensity increases. Similarly, for <code>white</code> we can use a linear membership function that increases as the intensity increases.</p><p>We can now implement and visualize our inference system.</p><pre><code class="language-julia hljs">using FuzzyLogic, Plots

fis = @mamfis function edge_detector(dx, dy)::Iout
    dx := begin
        domain = -1:1
        zero = GaussianMF(0.0, 0.1)
    end

    dy := begin
        domain = -1:1
        zero = GaussianMF(0.0, 0.1)
    end

    Iout := begin
        domain = 0:1
        black = LinearMF(0.7, 0.0)
        white = LinearMF(0.1, 1.0)
    end

    dx == zero &amp;&amp; dy == zero --&gt; Iout == white
    dx != zero || dy != zero --&gt; Iout == black
end
plot(fis)</code></pre><img src="e540bf73.svg" alt="Example block output"/><pre><code class="language-julia hljs">plot(plot(fis, :dx), plot(fis, :Iout), layout = (1, 2))</code></pre><img src="ad9a1d56.svg" alt="Example block output"/><p>We are now ready to apply our fuzzy edge detector to the input image. We will create a new image <code>Iout</code> and assign to each pixel the intensity value computed with our fuzzy system.</p><pre><code class="language-julia hljs">Iout = copy(img)

for idx in eachindex(Iout)
    Iout[idx] = fis(dx = img_x[idx], dy = img_y[idx])[:Iout]
end
Iout</code></pre><img src="745e06cb.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/type2/">« Build a type-2 inference system</a><a class="docs-footer-nextpage" href="../../api/fis/">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 19 September 2024 18:30">Thursday 19 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
